# المواصفات الفنية الكاملة لتطبيق Pathkin

## 1. مقدمة ونظرة عامة

### 1.1. هدف المشروع
Pathkin هو تطبيق ويب اجتماعي مصمم ليكون المنصة المثالية للمسافرين والرحالة والمغامرين. يهدف التطبيق إلى إنشاء مجتمع مترابط حيث يمكن للمستخدمين مشاركة خططهم، والعثور على شركاء للسفر أو السكن، واكتشاف الأنشطة والفعاليات، وبناء شبكة من العلاقات مع أشخاص يشاركونهم نفس الشغف.

### 1.2. الجمهور المستهدف
- الرحالة (Backpackers) والمسافرون المنفردون.
- البدو الرقميون (Digital Nomads).
- الطلاب الذين يدرسون في الخارج.
- أي شخص يبحث عن مغامرات وتجارب سفر أصيلة.

---

## 2. المتطلبات الوظيفية (Functional Requirements)

### 2.1. نظام المستخدمين والمصادقة
- **إنشاء حساب:** التسجيل باستخدام البريد الإلكتروني، جوجل، أو كضيف.
- **إعادة تعيين كلمة المرور:** عبر البريد الإلكتروني.
- **وضع الضيف (Guest Mode):** تصفح محدود الصلاحيات.

### 2.2. الصفحة الرئيسية (الخلاصة - Feed)
- عرض المغامرات من المستخدمين المتابعين.
- شريط القصص (Story Reel) في الأعلى.

### 2.3. القصص (Stories)
- **إنشاء قصة:** من الكاميرا أو معرض الجهاز (صور أو فيديو).
- **العرض:**
    - عرض القصص بملء الشاشة مع شريط تقدم.
    - تقدم تلقائي بين القصص (5 ثوانٍ للصور، مدة الفيديو للفيديو).
    - يتم عرض قصص المستخدم الواحد بتسلسل زمني من الأقدم إلى الأحدث.
- **الاختفاء التلقائي:** تختفي جميع القصص بعد 24 ساعة من نشرها.
- **مؤشر المشاهدة:** يظهر إطار ملون حول الصورة الشخصية للمستخدمين الذين لديهم قصص جديدة. يعود الإطار إلى طبيعته بعد مشاهدة القصص.
- **إدارة القصة:** يمكن للمستخدم حذف قصصه الخاصة.

### 2.4. إنشاء وتعديل المغامرات
- **نموذج إنشاء ديناميكي:** يتغير النموذج تلقائيًا بناءً على "نوع المغامرة" المختار، مما يوفر حقولًا مخصصة لكل نشاط.
- **حقول المغامرة:**
    - **نوع المغامرة (Adventure Type):** قائمة منسدلة (سفر، سكن، فعالية، إلخ).
    - **الخصوصية (Privacy):** عام، للمتابعين، لتوائم الميلاد.
        - **خصوصية متقدمة:** عند اختيار "توائم الميلاد"، يظهر خيار إضافي لجعل المغامرة مرئية أيضًا لـ "العامة" أو "المتابعين".
    - **العنوان (Title)** و **الوصف (Description)**.
    - **مساعد الوصف بالذكاء الاصطناعي:** باستخدام Gemini API، يولد وصفًا تلقائيًا بناءً على **نوع المغامرة**، العنوان، والكلمات المفتاحية.
    - **الوسائط (Media):** رفع صورة أو فيديو.
    - **اختيار من الخريطة (Select from Map):** نافذة خريطة تفاعلية لتحديد الموقع بدقة.
- **حقول ديناميكية حسب النوع:**
    - **السفر (Travel):** حقل "من" (From) والقدرة على إضافة وجهات متعددة "إلى" (To).
    - **السكن (Housing):** حقول لـ "السعر" (Price)، "عدد الغرف" (Room Count)، وفترة التوفر "من" و "إلى".
    - **فعالية (Event):** حقل لاختيار "فئة الفعالية" (موسيقى، فن، طعام، إلخ).
    - **هايكنج وركوب الدراجات (Hiking/Cycling):** حقول لتحديد "نقطة البداية" و "نقطة النهاية".
- **إدارة المغامرة:** يمكن لصاحب المغامرة **تعديل** جميع التفاصيل (بما في ذلك الحقول الديناميكية) أو **حذف** المغامرة.

### 2.5. التفاعل مع المغامرات
- إبداء الاهتمام (Interest)، التعليقات، إعادة النشر، الحفظ، المشاركة.
- **استجابة فورية للواجهة (Optimistic UI):** تتغير ألوان وحالة أزرار (الحفظ، إعادة النشر، تمييز كمكتمل) فورًا عند النقر.

### 2.6. البحث والاستكشاف
- بحث بالكلمات المفتاحية وفلاتر متقدمة.
- عرض النتائج على الخريطة.
- البحث عن توأم الميلاد.

### 2.7. عرض الخريطة
- **عرض الخريطة التفاعلي:** باستخدام Google Maps Platform.
- **عرض الموقع الحالي:** طلب إذن وعرض موقع المستخدم.
- **أيقونات مخصصة:** علامات فريدة لكل نوع مغامرة.
- **فلترة حسب النوع:** شريط فلاتر أيقوني أعلى الخريطة.
- **رسم المسارات (Route Drawing):** عند النقر على مغامرة "هايكنج" أو "ركوب دراجات"، يتم استخدام Directions API لرسم المسار المقترح على الخريطة من نقطة البداية إلى النهاية.

### 2.8. الملف الشخصي للمستخدم
- عرض المعلومات الأساسية والإحصائيات.
- تبويبات للمغامرات، المحفوظات، إعادة النشر، والأنشطة المكتملة.

### 2.9. الرسائل والإشعارات
- **الإشعارات:** إشعارات فورية للرسائل، إبداء الاهتمام (Likes)، والتعليقات.
- **نظام الرسائل:** واجهة محادثات حديثة مع شارة للرسائل غير المقروءة، قراءة تلقائية، وتصميم يحاكي التطبيقات الشهيرة.

### 2.10. الإعدادات
- تعديل الملف الشخصي، الخصوصية، اللغة، وعرض المغامرات المحفوظة.

---

## 3. نماذج البيانات (Data Models / Schema)

### 3.1. `User` (مستخدم)
(لا تغييرات كبيرة، يحتوي على `id`, `name`, `username`, `followers`, `following`, etc.)

### 3.2. `Adventure` (مغامرة)
```typescript
interface Adventure {
  id: string;
  type: AdventureType;
  authorId: string;
  title: string;
  description: string;
  location: string; // تمثل "نقطة البداية" للرحلات والمسارات
  coordinates?: { lat: number; lng: number };
  startDate: string;
  endDate?: string;
  budget: number; // تمثل "السعر" للسكن
  interestedUsers: string[];
  commentCount: number;
  createdAt: string;
  media?: { url: string; type: 'image' | 'video'; }[];
  privacy: AdventurePrivacy;
  
  // حقل جديد للخصوصية المتقدمة
  subPrivacy?: AdventurePrivacy.Public | AdventurePrivacy.Followers;

  // حقول ديناميكية حسب النوع
  // للسفر (Travel)
  destinations?: { location: string; coordinates: { lat: number; lng: number } }[];

  // للسكن (Housing)
  roomCount?: number;

  // للفعاليات (Event)
  eventCategory?: string;

  // للهايكنج وركوب الدراجات
  endLocation?: string;
  endCoordinates?: { lat: number; lng: number };
}
```

### 3.3. `Conversation` (محادثة)
```typescript
interface Conversation {
  id: string;
  participants: string[];
  lastMessage?: Message;
  updatedAt: string;
  unreadCount?: { [key: string]: number; };
}
```

---

## 4. تصميم واجهة المستخدم وتجربة المستخدم (UI/UX)
- **تصميم مركزي ومريح:** عرض محدد ومركزي على الشاشات الكبيرة مع قائمة جانبية في أقصى اليسار.
- **تصميم متجاوب:** يتكيف بسلاسة مع أحجام الشاشات المختلفة.
- **هوية بصرية:** استخدام متسق للون البرتقالي كعلامة تجارية، مع دعم الوضعين الفاتح والداكن.

---

## 5. الحزمة التقنية (Technical Stack)
- **الواجهة الأمامية (Frontend):** React, TypeScript, Vite, Tailwind CSS
- **الخلفية وقاعدة البيانات (Backend & Database):** Firebase (Authentication, Firestore, Storage)
- **واجهات برمجة التطبيقات (APIs):**
    - **Google Maps Platform:** for Places Autocomplete, Geocoding, Map display, and **Directions API**.
    - **Google Gemini API:** for AI-powered description generation.
- **النشر (Deployment):** GitHub Pages

---

## 6. هيكل المشروع (Project Structure)

```
/src
├── components/     # مكونات React (شاشات، بطاقات، أزرار)
│   ├── icons/      # أيقونات SVG
│   └── settings/   # مكونات شاشات الإعدادات
├── contexts/       # React Contexts لإدارة الحالة (مثل اللغة)
├── data/           # بيانات ثابتة (مثل قائمة الدول)
├── services/       # وحدات للتفاعل مع APIs الخارجية (Firebase, Gemini)
├── utils/          # دوال مساعدة عامة
├── App.tsx         # المكون الجذري للتطبيق
├── types.ts        # تعريفات TypeScript لأنواع البيانات
└── index.css       # الأنماط الأساسية لـ Tailwind
```